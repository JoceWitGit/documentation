<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Procedures for working with EC2 instances">
<meta name="keywords" content="AWS,  aws, instances, procedures">
<title>EC2 Instances | Research Computing Resources</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-purple.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://idratherbewriting.comfeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Research Computing Resources</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="calendar.html">Calendar</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Jekyll Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/tomjohnson1492/documentation-theme-jekyll" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://talk.jekyllrb.com" target="_blank">Jekyll Talk</a></li>
                        
                        
                        
                        <li><a href="http://jekyllrb.com/docs/home/" target="_blank">Jekyll documentation</a></li>
                        
                        
                        
                        <li><a href="http://stackoverflow.com/questions/tagged/jekyll" target="_blank">Jekyll on Stack Overflow</a></li>
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/category-jekyll/" target="_blank">Jekyll on my blog</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:amandach@uw.edu?subject=Cloud maven f eedback&body=I have some feedback about the EC2 Instances page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="EC2 Instances">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Documentation </li>
    
    
    
        
    
    <li>
        <a href="#">Cloud Core</a>
        <ul>
            
            
            
            <li><a href="cc_what_is_the_cloud.html">What is the cloud?</a></li>
            
            
            
            
            
            
            <li><a href="cc_data_security.html">Data security</a></li>
            
            
            
            
            
            
            <li><a href="cc_glossary.html">Glossary</a></li>
            
            
            
            
            
            
            <li><a href="cc_cost_management.html">Cost management</a></li>
            
            
            
            
            
            
            <li><a href="cc_compute_power.html">Compute power</a></li>
            
            
            
            
            
            
            <li><a href="cc_docker_containers.html">Docker containers</a></li>
            
            
            
            
            
            
            <li><a href="cc_internet_of_things.html">Internet of things</a></li>
            
            
            
            
            
            
            <li><a href="cc_technical.html">Cloud technical</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Proposals</a>
        <ul>
            
            
            
            <li><a href="p_consulting.html">Consulting</a></li>
            
            
            
            
            
            
            <li><a href="p_costing.html">Costing</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Research computing</a>
        <ul>
            
            
            
            <li><a href="http:escience.washington.edu">WRF Data Science Studio</a></li>
            
            
            
            
            
            
            <li><a href="rc_data_science.html">Data science</a></li>
            
            
            
            
            
            
            <li><a href="rc_research_on_the_web.html">Research on the web</a></li>
            
            
            
            
            
            
            <li><a href="rc_github.html">GitHub</a></li>
            
            
            
            
            
            
            <li><a href="rc_visualization_python.html">Visualization Python</a></li>
            
            
            
            
            
            
            <li><a href="rc_visualization_virtual_globes.html">Visualization virtual globes</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">AWS</a>
        <ul>
            
            
            
            <li><a href="aws_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="aws_console.html">Console</a></li>
            
            
            
            
            
            
            <li><a href="aws_account_management.html">Account management</a></li>
            
            
            
            
            
            
            <li><a href="aws_ec2.html">EC2</a></li>
            
            
            
            
            
            
            <li><a href="aws_spot_market.html">Spot market</a></li>
            
            
            
            
            
            
            <li><a href="aws_cluster.html">Cluster</a></li>
            
            
            
            
            
            
            <li><a href="aws_storage.html">Storage</a></li>
            
            
            
            
            
            
            <li><a href="aws_jupyter.html">Jupyter</a></li>
            
            
            
            
            
            
            <li><a href="aws_hipaa.html">HIPAA</a></li>
            
            
            
            
            
            
            <li><a href="aws_iot.html">IoT</a></li>
            
            
            
            
            
            
            <li><a href="aws_spark.html">Spark</a></li>
            
            
            
            
            
            
            <li><a href="aws_rds.html">Database</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Azure</a>
        <ul>
            
            
            
            <li><a href="az_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="az_training.html">Training</a></li>
            
            
            
            
            
            
            <li><a href="az_portal.html">Portal</a></li>
            
            
            
            
            
            
            <li><a href="az_account_management.html">Account management</a></li>
            
            
            
            
            
            
            <li><a href="az_visual_studio.html">Visual Studio</a></li>
            
            
            
            
            
            
            <li><a href="az_web_framework.html">Web Framework</a></li>
            
            
            
            
            
            
            <li><a href="az_machine_learning.html">Machine Learning</a></li>
            
            
            
            
            
            
            <li><a href="az_spark.html">Spark</a></li>
            
            
            
            
            
            
            <li><a href="az_hipaa.html">HIPAA</a></li>
            
            
            
            
            
            
            <li><a href="az_jupyter.html">Jupyter</a></li>
            
            
            
            
            
            
            <li><a href="az_database.html">Database</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">AWS Case Studies</a>
        <ul>
            
            
            
            <li><a href="acs_genome_association.html">Genome Association</a></li>
            
            
            
            
            
            
            <li><a href="acs_geoserver.html">Geospatial Data Sharing</a></li>
            
            
            
            
            
            
            <li><a href="acs_rosetta.html">Rosetta</a></li>
            
            
            
            
            
            
            <li><a href="acs_neurohackweek.html">Neurohackweek</a></li>
            
            
            
            
            
            
            <li><a href="acs_cfd.html">CFD</a></li>
            
            
            
            
        </ul>
        
        
    
        
    
    <li>
        <a href="#">Azure Case Studies</a>
        <ul>
            
            
            
            <li><a href="azcs_geospatial_api.html">Geospatial API</a></li>
            
            
            
            
            
            
            <li><a href="azcs_organic_chemistry.html">Organic chemistry</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Google</a>
        <ul>
            
            
            
            <li><a href="g_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="g_earth_engine.html">Earth Engine</a></li>
            
            
            
            
            
            
            <li><a href="g_app_engine.html">App Engine</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">EC2 Instances</h1>
</div>



<div class="post-content">

   
    <div class="summary">Procedures for working with EC2 instances</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/tomjohnson1492/documentation-theme-jekyll/blob/gh-pages/pages//_pages/aws/aws_ec2instances.html.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    

  <h2 id="introduction">Introduction</h2>
<p>An EC2 (Elastic Cloud Compute) instance is essentially a virtual server; it is no different from having a Linux (or Windows) box sit under 
your desk except that if you need to scale your applications i.e. increase computing capacity or expand storage, you don’t have to run out 
to Silicon Mechanics or Best Buy to purchase new machinery - you can essentially get a new CPU or multiple CPUs and hard drives with the 
click of a button. Please read our Cloud Core pages on how <a href="/cloud_computepower.html">cloud compute service</a> may be suitable for your 
project, how to <a href="/cloud_cost.html">cost</a> and where to <a href="/cloud_intro.html">begin</a>!</p>

<p>The purpose of this page is to describe the terminology and relationships of Amazon Web Services (AWS) EC2 instances, AMIs, Elastic Block 
Storage (EBS) and Snapshots of EBS volumes: Broadly EC2 Resources. EBS or Elastic Block Storage and EFS or Elastic File System are two ways 
of managing operational memory in AWS EC2 instances and clusters.  In passing we also define / describe Elastic IPs and Key Pairs and sharing 
access to S3. This document does not currently cover EFS, Elastic File System.</p>

<h2 id="pricing">Pricing</h2>
<p>EC2 Instance pricing: https://aws.amazon.com/ec2/pricing/on-demand/
<a href="http://calculator.s3.amazonaws.com/index.html">AWS Calculator</a></p>

<h2 id="setting-up-an-ec2-instance">Setting up an EC2 Instance</h2>

<p>Links
https://aws.amazon.com/ebs/
https://aws.amazon.com/efs/
https://aws.amazon.com/training/course-descriptions/bigdata-fundamentals/</p>

<p>As noted the terminology here applies to AWS technology.</p>

<p>The ‘compute’ part of the cloud begins with Virtual Machines that are called Elastic Cloud Compute = ECC = EC2 <strong><em>instances</em></strong>. To get started 
with EC2 instances you would log on to the AWS console, click on the EC2 icon and follow the buttons to create a new instance; which takes a 
few minutes. And then you can log in to that machine and use it like any other computer. It has an operating system that you choose, it has 
some amount of computing power that you choose, it has some amount of RAM that you choose and it has very little disk space.</p>

<p>This is the big Aha: You also want to attach some disk space in the process as well. The generic term for disk space is a disk volume. You can 
attach these volumes (more than one is fine) in the spin-up process or you can attach them later. This is Elastic Block Storage (EBS). A single 
EBS volume can be up to 16 Terabytes.</p>

<p>Let’s assume EBS is where you’ll keep your data; and so to safely make a back-up copy of that EBS volume you can periodically take snapshots of it. 
The snapshots bundle up all the stuff in the volume and put that (like a big zip file) in S3 storage. That storage is completely separate from the 
EC2 instance and its attached EBS volumes. You can also bundle up an image of the entire EC2 instance into storage. This is a snapshot combined 
with some additional instructions on setting up the instance; and together these comprise an AMI for Amazon Machine Image. So there are two levels 
of granularity in backing up your work: Snapshots and AMIs.</p>

<p>Now how much does this cost? The EBS costs ten cents per GB-month. Storage costs three cents per GB-month; so if you have a lot of data this is 
considerable cost savings, putting your EC2 instance in storage by means of an AMI; or putting your disk volume in storage by means 
of a snapshot. The EC2 instance itself (not considering the cost of the EBS) will vary with which machine you chose. A cheap machine is free 
(T2.micro). A basic, simple low-power machine will cost three cents per hour. A fairly powerful machine will cost perhaps 40 cents per 
hour. You can also rent super-powerful machines for several dollars per hour. Since that adds up it is important to know that you can turn these 
machines off (without losing your data) so that you are not paying for them when you are not using them.</p>

<h3 id="what-this-page-is--isnt">What this page is / isn’t</h3>
<p>Now this document is in preparation; so it does not cover everything in this topic. For example it does not cover how to 
save money by using the Spot Market and it does not cover turning EC2 instances on and off and setting Alarms to inform you when they are possibly doing something 
expensive. We’ll build all of this into these documentation pages; but the main point of this page at the moment is Resources: The short list 
of items that you tend to build and associate with EC2 instances. This includes AMIs, Snapshots, Key Pairs, and Elastic IPs.</p>

<h2 id="making-an-ami">Making an AMI</h2>
<p>An EC2 instance: We take as a given. (Although we don’t have down “Encrypted” but let’s just flag that with kilroy. Notice I can create an AMI 
quite easily using the menu. Here is the configuration page:</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic1.png" alt="pic1" /></p>

<h2 id="resource-overview">Resource Overview</h2>
<p>Returning to the EC2 Resource summary: Let’s take a look at what’s what here term by term: 
<img src="/documentation/images/aws_procedurals/aws_ec2instances_pic2.png" alt="pic2" /></p>

<p>In this region I’m not (apparently) running any instances.</p>

<h2 id="elastic-ip">Elastic IP</h2>

<p>An Elastic IP is a convenient persistent ip address associated with my account (and with a particular machine unless that machine gets blown away). 
It is said to be ‘publicly routable’: It is visible/findable on the internet.</p>

<p>AWS will hand us some number of these on demand for very little money. If we do not request this, however, then the default is a temporary public ip 
address that is only good as long as the instance is up and running. Shut it down and that ip evaporates.</p>

<p>An Elastic IP is persistent on my account and could even be detached and re-attached to something else. This is like having a piece of public plumbing 
at my disposal… to a resource that I want to share for example.  This ip stuff is distinct from a DNS entry. The latter is a person
-friendly string associated with an ip address (free or maybe for a nominal fee).</p>

<h2 id="dedicated-host">Dedicated Host</h2>
<p>A Dedicated Host is a physical computer which permits only me (my AWS account) to be connected. It does not thread in other virtual operating systems or 
other accounts.  This is an important concept in HIPAA compliance.</p>

<h2 id="snapshot">Snapshot</h2>
<p>A Snapshot is always drawn from, i.e. is an image of some Elastic Block Storage (EBS). An 8GB Snapshot is quite likely the root 
volume of an AWS Linux EC2 instance. However if you attach more EBS – like say 2TB – to that instance you can make a separate larger Snapshot.</p>

<h2 id="ami">AMI</h2>
<p>An AMI is a Snapshot together with some instructions for standing up an EC2 instance. Hence: When you create an AMI part of that process is a Snapshot 
or Snapshots of all the EBS volumes associated with that instance.</p>

<h2 id="snapshot-to-ami-conversion-in-linux">Snapshot to AMI Conversion in Linux</h2>
<p>You can “upgrade” a Snapshot to an AMI in Linux… but it is more complicated for Windows. And this is a little bit vague: Do 
we mean that the snapshot is of the Root volume or an attached volume? The rebuilt AMI – in the case where the original AMI instructions are unavailable – 
will be built out rather generically. This is one of these digressions that can drive one crazy so let’s leave it there for now.</p>

<h2 id="understanding-a-snapshot-listing">Understanding a Snapshot listing</h2>
<p>When you look at your Snapshot listing:</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic3.png" alt="pic3" /></p>

<p>CreateImage is a facility for building an AMI. Fine. 
…is an instance ID. 
…is an AMI ID.</p>

<h2 id="snapshot-archaeology">Snapshot Archaeology</h2>
<p>Suppose you have an old Snapshot and you are not sure what is on it; and if nothing you might want to delete it. 
Now can you look at it? If the associated AMI is gone you can always create a Volume from the Snapshot, Attach the Volume to some other EC2 
instance in the same Availability Zone, mount the Attached Volume and peruse the file system in the usual way.  Maybe your important data is still there!</p>

<p>Create the Volume from the Snapshot</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic4.png" alt="pic4" /></p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic5.png" alt="pic5" /></p>

<p>I will choose Magnetic because it is a bit cheaper… this is just an example. If I wish to have speed I would stay with SSD.</p>

<p>The Volume is created very quickly.</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic6.png" alt="pic6" /></p>

<p>Here it is, now listed in the Volume table:</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic7.png" alt="pic7" /></p>

<p><strong>PRO TIP: When you create a Volume from a Snapshot make sure it is in the same Availabilty Zone (AZ) as the Instance that you intend 
to attach it to. Failing to do so is a waste of time: You can’t attach a Volume in Oregon to an EC2 in Virginia. 
In fact you can’t attach a Volume in Virginia 1-a to an EC2 in Virginia 1-b.  Virginia is a Region, 1-a is the Availability Zone.</strong></p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic8.png" alt="pic8" /></p>

<p>That’s where my restored Volume is. Oh look I have a machine there also; though it is Stopped: Let us Start it.</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic9.png" alt="pic9" /></p>

<p>This finds a host, creates a VM, points to the associated storage all of this takes a few minutes but you can be impatient and see if 
you can Attach the restored Snapshot Volume whenever you like.</p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic10.png" alt="pic10" /></p>

<p><img src="/documentation/images/aws_procedurals/aws_ec2instances_pic11.png" alt="pic11" /></p>

<h2 id="mounting-the-attached-volume">Mounting the Attached Volume</h2>
<p>To check if there is an attached volume, log on (ssh) onto your EC2 instance (Original recipe located <a href="http://maplpro.blogspot
.com/2012/05/how-to-mount-ebs-volume-into-ec2-ubuntu.html">here</a>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>First see if it is attached with:

&gt;&gt; sudo fdisk -l
Disk /dev/xvdc: 10.7 GB, 10737418240 bytes

Then format it (if you haven't already done it)
&gt;&gt; sudo mkfs -t ext4 /dev/xvdc

Create dir where it will be mounted:
&gt;&gt;mkdir /data

That's it you can mount it:
&gt;&gt;sudo mount /dev/xvdc /data

Check if it has been mounted correctly with:
&gt;&gt;mount -l
/dev/xvdc on /data type ext4 (rw)

Make it to mount automatically on system start
&gt;&gt;sudo vim  /etc/fstab

and add this:
/dev/xvdc       /data   auto    defaults,nobootwait     0       0```

That's it. Make sure your read and write permissions are set accordingly using chmod. 
## What is the Snapshot ID?
Here is a screen capture of some volumes:

![pic12](/documentation/images/aws_procedurals/aws_ec2instances_pic12.png)

Each is attached to an EC2 instance. Notice these have a snapshot ID. This means that these volumes were created from a snapshot, for example from an 
AMI = Snapshot + instructions. It does not mean that this snapshot still exists; or that if it did exist it would reflect what is actually in the 
restored volume. That volume probably has changed. So to explore these volumes:  Again we would ssh into the EC2 instance associated and go look at the file 
system.

In the case above, by the way, as noted earlier: These are all tell-tale Linux OS root volumes because the default on AWS Linux EC2 instances is 8GB. 

***Pro Tip: Returning to the snapshot table comment field ('Created by... in our example above): This can have anything in there (User defined) when the snapshot is of an EBS without this AMI association business.*** 

This concludes the overview of Snapshots and AMIs and the archaeological process of figuring out what is preserved on an artifact Snapshot.

## Key Pairs
In the Resource summary table there is an entry for Key Pairs. Let's cover what these are next. A Key Pair is both a public and 
a private key; and we will be primarily discussing the use of the private key file to authenticate into an AWS EC2 instance using the secure shell (ssh
) protocol.

Start up an EC2 instance. You need an initial way of getting in via ssh. Rather than use a password let's use Key Pair authentication. 
I get the private Key file; and it contains JUST a private key: A long string of characters. Let's not publish this on Github. 

When I authenticate using PuTTY I set it to use this private key. PuTTY uses the '.ppk' version of the key but AWS only gives out a 
'.pem' version of that file. No problem: There is a separate application called PuTTYGen that does the conversion. So procedurally: 
	1. Generate the EC2 instance
	2. From the AWS Console: Get the key file associated.
	3. Install both PuTTY and PuTTYGen (both will install in a PuTTY package)
	4. Run PuTTYGen and convert the key file from .pem to .ppk format
	5. Run PuTTY and use the .ppk file to log in to the instance.

To ssh to this EC2 instance I will need to know what username to enter.  This can vary from one EC2 instance type (OS) to another. 
For example on an AWS-styled Linux machine the user name is ec2-user. On an AWS EC2 Ubuntu instance the username is ubuntu. 

Now I have logged in to the machine using ssh. I can sudo anything I want. Success.

How do I log in in the future? How do others log in? Three options: 
	1. I can use the key that I have and/or give that key to someone else. 
	2. I can generate a new key on that machine and share that key. This has nothing to do with AWS. I could do it with a script for example, using Linux commands. 
	3. I can enable logging in by username and password. 

Notice that ssh is a secure (encrypted) tunnel through which these keys are passing.

https://en.wikipedia.org/wiki/Secure_Shell

This security level is maintained as a separate effort by ssh / PuTTY. (PuTTY is the application and ssh is the cryptographic network protocol. 

## Ssh, PuTTY, scp and WinSCP
Now that we have identified PuTTY as the ssh-using application let's go a bit further. Ssh is also a Linux command for logging into another 
machine; so in a sense PuTTY is the Windows equivalent of the Linux ssh. Similarly there is a secure copy program in Linux called scp. The Windows analog is WinSCP. 

## More on Keys
Keys are actually generated in pairs: The public and private key pair are associated; and the public key can be openly shared. For more on this see 
https://en.wikipedia.org/wiki/Public-key_cryptography

On AWS I can only generate one key pair per machine. The private key recognition machinery is injected into the instance when it launches the first time; and 
I can start multiple instances using that same key. If I create an AMI and use that to generate many EC2 instances: Again just one private key provides 
access to all of them. One key can map to many EC2 instances in the context of AWS. 

## Keys Versus S3 Access Sharing
Let's take a moment to contrast Key-based access to an EC2 instance with the process of sharing files using S3 buckets. The latter is done 
using IAM permissions, specifically using a Bucket Policy. 

Sharing between AWS accounts is straightforward. If my friend has an AWS account then I just set that up in the S3 bucket policy by referring to his account 
number. So he has to send me that. 

Sharing with non-AWS-account holders is also easy and there are several options. If my collaborator has no AWS account I have three broad categories of approach: IAM User, Web Server and Signed URL.
	• IAM User method: I get an Access Key and a Secret Key. I do not think this is the same thing as a Key Pair but I could be proven wrong. I receive these two keys for example when I create a User. They reside in a single credential file. I click "Download Credentials" and there it is in ASCII. The file is in CSV format and includes a user name, an access key and a secret key (all strings). 
		○ There are three ways of getting to the S3 bucket now for that person. 
			§ Third party tool: Cloudberry, Cyberduck, etcetera
			§ AWS command line interface (CLI)
			§ An API call
		○ Notice this does NOT involve the Web Console. 
			§ They can only use the AWS Web Console if I generate a password for them using IAM. 
	• Put a web server / web app in front of the S3 bucket. This pushes the problem down a level, so to speak.
	• Generate a signed URL
		○ Gives access to one object during the time-to-live associated with that URL. 
		○ This can be done on the CLI or in one of those applications (Cloudberry etc)
			§ Look for the button that says 'Generate signed URL'

So now we have covered Key Pairs and differentiated Key Pair use from S3 access. 

## Mounting an EBS to your Instance

# Concatenating the Resources page to the EC2 page

## Introduction
On the Amazon Web Services (AWS) public cloud we frequently rent computers; and these are called *EC2 instances*. EC2 instances are documented elsewhere at 
[cloudmaven.org](http://cloudmaven.org). 
The purpose of this page is to review some of the cloud resources that are associated with EC2 instances, things like persistent ip addresses and 
human-friendly names for websites called DNS entries. 

## FTP Setup and EC2 Instance
Overview: Create a virtual machine, install the ftp server and setup user accounts. Bonus: Bind your EC2 instance to an Elastic IP so you can reuse the same 
public IP even if your instance changes!

1.  Sign up for a free AWS account [here](https://aws.amazon.com/free). Usage and free tier information available 
[here](https://aws.amazon.com/free/?sc_ichannel=ha&amp;amp;sc_ipage=signin&amp;amp;sc_iplace=body_link_text&amp;amp;sc_icampaigntype=free_tier&amp;amp;sc_icampaign=ha_en_free_tier_signin_2014_03). 
You will need to provide credit card information, but won't be billed unless you exceed the free tier usage limits. Don't worry, you can set up 
alarms to alert you when you're near the limit! More on that later. 

2.  [This recipe](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EC2_GetStarted.html) from AWS is straightforward. Print it out and don't skip a 
step. An EC2 (elastic compute cloud) is your virtual computing environment i.e. your virtual machine. This video by Microwave Sam expands on the EC2 setup.   

    &lt;iframe style="display: block; margin-left: auto; margin-right: auto;" src="//www.youtube.com/embed/wNr7YqjjzOY" width="425" height="350"&gt;&lt;/iframe&gt;  

3.  Once your virtual machine is setup, you can access your "computer in the cloud" by securely tunneling in via the Terminal on your macbook, 
ssh on your Unix machines and Putty or other Unix environment emulator on Windows. 

4.  You can now set up an FTP server on your virtual machine. 

5.  The first solution [here on Stackoverflow](http://stackoverflow.com/questions/7052875/setting-up-ftp-on-amazon-cloud-server) is 
non-tortuous and really easy to follow. Thanks, clone45!

6.  You should now be able to use an FTP client to connect to your ftpserver. 

7.  If you can't connect, check your directory permissions on your virtual machine! 

8.  Again, follow instructions and don't skip a step!

## Elastic IPs

The annoying thing I've experienced with AWS is that every time you stop and restart an instance, you get assigned a new public DNS for your instance 
(e.g. public DNS = ec2-52-41-144-22.us-west-2.compute.amazonaws.com). 
You can get around this by associating ypur instance with an Elastic IP. Steps are outlined 
[here](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html). 
Once you've associated the Elastic IP with a running instance, you can ssh into the VM with the Elastic IP but using the previous public key generated 
for the instance. Don't forget to update the vsftpd.conf with your new Elastic IP address which is now your public address.

</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>&gt; sudo vi /etc/vsftpd/vsftpd.conf
pasv_address=&lt;Elastic IP address&gt;
&gt; sudo /etc/init.d/vsftpd restart ``` MS Azure on the other hand, let's you choose your on public DNS hostname which reduces the need for this workaround.
</code></pre>
</div>

<h2 id="dns-hostnames">DNS Hostnames</h2>

<p>If you have your own registered domain, you can set your A-Record to point to the Elastic IP address of your instance. That gets rid of 
the unsightly public DNS that AWS assigns to you. Here’s the example for cloudmaven.org (our domain registrar is Namecheap.com): 
<img src="https://raw.githubusercontent.com/amandalehr/cloudmaven/master/dns-eg.tiff" alt="" /></p>

<p>An A-record points the hostname (here “compute”) to the AWS instance Elastic IP (here “52.41.144.22”). I 
can then ssh into my compute instance using ec2-user@compute.cloudmaven.org. You can also set up similarly an A record called ftp that 
points to the elastic IP of your ftp server instance to allow ftp access into say ftp.cloudmaven org</p>

<h2 id="ec2-instance-background">EC2 instance background</h2>
<p>Download PDF <a href="/documentation/pdf/Doc46_EC2_Resources_on_AWS.pdf">here</a></p>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_AWS.html" class="btn btn-default navbar-btn cursorNorm" role="button">AWS</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 cloudmaven. All rights reserved. <br />
<span>Page last updated:</span> January 26, 2017<br/> Site last generated: Jan 26, 2017 <br />
<p><img src="images/Picture1.gif" alt="Company logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>

</body>

</html>