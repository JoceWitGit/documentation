<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="AWS account management">
<meta name="keywords" content="AWScloud_basicsconsoleapiaccount_management,  aws">
<title>AWS Account Management | Research Computing Resources</title>
<link rel="stylesheet" href="css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<link rel="stylesheet" href="css/lavish-bootstrap.css">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/theme-purple.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://idratherbewriting.comfeed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });
            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });
        });
    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Research Computing Resources</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                
                
                <li><a href="calendar.html">Calendar</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Jekyll Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        
                        <li><a href="https://github.com/tomjohnson1492/documentation-theme-jekyll" target="_blank">Github Repo</a></li>
                        
                        
                        
                        <li><a href="https://talk.jekyllrb.com" target="_blank">Jekyll Talk</a></li>
                        
                        
                        
                        <li><a href="http://jekyllrb.com/docs/home/" target="_blank">Jekyll documentation</a></li>
                        
                        
                        
                        <li><a href="http://stackoverflow.com/questions/tagged/jekyll" target="_blank">Jekyll on Stack Overflow</a></li>
                        
                        
                        
                        <li><a href="http://idratherbewriting.com/category-jekyll/" target="_blank">Jekyll on my blog</a></li>
                        
                        
                    </ul>
                </li>
                
                
                
			<li><a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:amandach@uw.edu?subject=cloud maven f eedback&body=I have some feedback about the AWS Account Management page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a><li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="AWS Account Management">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">
          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Documentation </li>
    
    
    
        
    
    <li>
        <a href="#">Cloud Core</a>
        <ul>
            
            
            
            <li><a href="cc_what_is_the_cloud.html">What is the cloud?</a></li>
            
            
            
            
            
            
            <li><a href="cc_data_security.html">Data security</a></li>
            
            
            
            
            
            
            <li><a href="cc_glossary.html">Glossary</a></li>
            
            
            
            
            
            
            <li><a href="cc_cost_management.html">Cost management</a></li>
            
            
            
            
            
            
            <li><a href="cc_compute_power.html">Compute power</a></li>
            
            
            
            
            
            
            <li><a href="cc_docker_containers.html">Docker containers</a></li>
            
            
            
            
            
            
            <li><a href="cc_internet_of_things.html">Internet of things</a></li>
            
            
            
            
            
            
            <li><a href="cc_technical.html">Cloud technical</a></li>
            
            
            
            
            
            
            <li><a href="cc_network.html">Network</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Proposal Prep</a>
        <ul>
            
            
            
            <li><a href="p_consulting.html">Consulting</a></li>
            
            
            
            
            
            
            <li><a href="p_costing.html">Costing the cloud</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Research computing</a>
        <ul>
            
            
            
            <li><a href="rc_student_research.html">Student Research</a></li>
            
            
            
            
            
            
            <li><a href="rc_cloud101_immersion.html">Cloud 101 Immersion</a></li>
            
            
            
            
            
            
            <li><a href="rc_Foster101.html">Foster 101</a></li>
            
            
            
            
            
            
            <li><a href="http:escience.washington.edu">WRF Data Science Studio</a></li>
            
            
            
            
            
            
            <li><a href="rc_yun_zhou_guan.html">Yun Zhou Guan (Cloud Library)</a></li>
            
            
            
            
            
            
            <li><a href="rc_data_science.html">Data science</a></li>
            
            
            
            
            
            
            <li><a href="rc_research_on_the_web.html">Research on the web</a></li>
            
            
            
            
            
            
            <li><a href="rc_github.html">GitHub</a></li>
            
            
            
            
            
            
            <li><a href="rc_jupyterhub.html">JupyterHub</a></li>
            
            
            
            
            
            
            <li><a href="rc_visualization_python.html">Visualization Python</a></li>
            
            
            
            
            
            
            <li><a href="rc_visualization_virtual_globes.html">Visualization virtual globes</a></li>
            
            
            
            
            
            
            <li><a href="rc_lightweight_data_systems.html">Lightweight Data Systems</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Curriculum</a>
        <ul>
            
            
            
            <li><a href="curr_notebooks.html">Jupyter for coursework</a></li>
            
            
            
            
            
            
            <li><a href="curr_yun_zhou_guan.html">Cloud Library</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">AWS</a>
        <ul>
            
            
            
            <li><a href="aws_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="aws_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="aws_console.html">Console</a></li>
            
            
            
            
            
            
            <li class="active"><a href="aws_account_management.html">Account management</a></li>
            
            
            
            
            
            
            <li><a href="aws_cost_tracking.html">Cost Tracking</a></li>
            
            
            
            
            
            
            <li><a href="aws_cost_notification_system.html">Cost Notification System</a></li>
            
            
            
            
            
            
            <li><a href="aws_ec2.html">EC2</a></li>
            
            
            
            
            
            
            <li><a href="aws_spot_market.html">Spot market</a></li>
            
            
            
            
            
            
            <li><a href="aws_cluster.html">Cluster</a></li>
            
            
            
            
            
            
            <li><a href="aws_storage.html">Storage</a></li>
            
            
            
            
            
            
            <li><a href="aws_lambda.html">Lambda</a></li>
            
            
            
            
            
            
            <li><a href="aws_jupyter.html">Jupyter</a></li>
            
            
            
            
            
            
            <li><a href="aws_hipaa.html">HIPAA</a></li>
            
            
            
            
            
            
            <li><a href="aws_iot.html">IoT</a></li>
            
            
            
            
            
            
            <li><a href="aws_spark.html">Spark</a></li>
            
            
            
            
            
            
            <li><a href="aws_database.html">Database</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Azure</a>
        <ul>
            
            
            
            <li><a href="az_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="az_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="az_training.html">Training</a></li>
            
            
            
            
            
            
            <li><a href="az_portal.html">Portal</a></li>
            
            
            
            
            
            
            <li><a href="az_account_management.html">Account management</a></li>
            
            
            
            
            
            
            <li><a href="az_visual_studio.html">Visual Studio</a></li>
            
            
            
            
            
            
            <li><a href="az_web_framework.html">Web Framework</a></li>
            
            
            
            
            
            
            <li><a href="az_machine_learning.html">Machine Learning</a></li>
            
            
            
            
            
            
            <li><a href="az_spark.html">Spark</a></li>
            
            
            
            
            
            
            <li><a href="az_hipaa.html">HIPAA</a></li>
            
            
            
            
            
            
            <li><a href="az_jupyter.html">Jupyter</a></li>
            
            
            
            
            
            
            <li><a href="az_database.html">Database</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Google</a>
        <ul>
            
            
            
            <li><a href="g_overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="g_walkthrough.html">Walkthrough</a></li>
            
            
            
            
            
            
            <li><a href="g_app_engine.html">App Engine</a></li>
            
            
            
            
            
            
            <li><a href="g_big_query.html">BigQuery</a></li>
            
            
            
            
            
            
            <li><a href="g_compute_engine.html">Compute Engine</a></li>
            
            
            
            
            
            
            <li><a href="g_preemptible_instances.html">Preemptible Instances</a></li>
            
            
            
            
            
            
            <li><a href="g_earth_engine.html">Earth Engine</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Cloud Case Studies</a>
        <ul>
            
            
            
            <li><a href="ccs_precis.html">Precis</a></li>
            
            
            
            
            
            
            <li><a href="ccs_DIF.html">Dynamic Information Framework (DIF)</a></li>
            
            
            
            
            
            
            <li><a href="ccs_high_mountain_asia.html">High Mountain Asia (HiMAT/NASA)</a></li>
            
            
            
            
            
            
            <li><a href="ccs_OOI.html">Ocean Observing Initiative</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">AWS Case Studies</a>
        <ul>
            
            
            
            <li><a href="acs_light_sheet_microscope.html">Light Sheet Microscope</a></li>
            
            
            
            
            
            
            <li><a href="acs_epigenome_imputation.html">Epigenome Imputation</a></li>
            
            
            
            
            
            
            <li><a href="acs_nicadif.html">NicaDIF</a></li>
            
            
            
            
            
            
            <li><a href="acs_geoserver.html">Geoserver and LIDAR</a></li>
            
            
            
            
            
            
            <li><a href="acs_rosetta.html">Rosetta</a></li>
            
            
            
            
            
            
            <li><a href="acs_neurohackweek.html">Neurohackweek</a></li>
            
            
            
            
            
            
            <li><a href="acs_cfd.html">CFD</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Azure Case Studies</a>
        <ul>
            
            
            
            <li><a href="azcs_araldif.html">AralDIF</a></li>
            
            
            
            
            
            
            <li><a href="azcs_organic_chemistry.html">organic chemistry</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Google Case Studies</a>
        <ul>
            
            
            
            <li><a href="https://cloud.google.com/customers/colorado-center-for-personalized-medicine/" target="_blank">Health Data Compass - Colorado Center for Personalized Medicine</a></li>
            
            
            
            
            
            
            <li><a href="https://cloud.google.com/customers/stanford-universitys-center-of-genomics-and-personalized-medicine/" target="_blank">Center of Genomics and Personalized Medicine - Stanford University</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">AWS Account Management</h1>
</div>



<div class="post-content">

   
    <div class="summary">AWS account management</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    

  <h2 id="introduction">Introduction</h2>

<p>This page describes core AWS account management tasks in brief and then again in further detail. We assume that either
you are operating a research-credit based account provided directly from AWS or you are using a paid account established 
through the DLT third party provider. We make this and other distinctions as we go.</p>

<p>For UW Researchers: It is also possible for you to create an account directly with AWS but we recommend looking into
DLT-based accounts first as they provide some particular benefits such as egress waiver to 15% of your monthly bill.</p>

<h2 id="links">Links</h2>
<ul>
  <li><a href="http://aws.amazon.com">AWS</a></li>
  <li><a href="https://customerportal.dlt.com/internet2/">DLT portal for new AWS accounts</a></li>
  <li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html?icmpid=docs_iam_console#Using_RotateAccessKey">Rotating access keys: Documentation</a></li>
  <li><a href="https://wiki.cac.washington.edu/pages/viewpage.action?pageId=78712235">Confederate a UW NetID with AWS (wiki)</a></li>
  <li>Smart phone: <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html">Activating MFA</a> and <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_disable.html">De-activating MFA</a></li>
</ul>

<h2 id="warnings">Warnings</h2>

<ul>
  <li><strong><em>Read this and linked documents carefully to familiarize yourself with cloud account management issues and guidelines</em></strong></li>
  <li><strong><em>Do not start using a new AWS account until you have trained up on how to keep the account secure.</em></strong></li>
</ul>

<h2 id="dlt-issues">DLT issues</h2>

<p><strong>DLT</strong> is a company that brokers daughter accounts to UW from a single AWS account. The idea is to create some benefits to
the holders of the daughter accounts; but there is a major issue to be aware of.</p>

<p>DLT essentially blocks some AWS billing features when you move to their consolidated account.
In particular: Any alarms you set on your AWS prior to switching to the DLT consolidated account will stop working. 
The fix is after your DLT account is activated: Use CloudWatch alerts. These must be set by contacting DLT
using the email OpsCentral@dlt.com, providing your name, email, and an alarm threshold (monthly dollar amount
to act as a notification trigger).</p>

<p>At this stage (kilroy) we should discuss less indirect approaches.</p>

<h2 id="paid-aws-accounts">Paid AWS accounts</h2>

<p>We assume you are at the University of Washington or are a covered <em>affiliate</em> of the University.</p>

<ul>
  <li>Establish a Blanket Purchase Order</li>
  <li>Email the UW help desk (help at uw dot edu) with the subject AWS Account. Ask for instructions on how to proceed.</li>
</ul>

<h2 id="account-set-up">Account set-up</h2>

<ul>
  <li>Set up your account to have “all green checkmarks”. This means you are logged out and back in as an <strong>admin</strong>.
    <ul>
      <li>After a year or so you may be encouraged to ‘rotate your access keys’; see the link provided above</li>
      <li>One of those checkmarks is enabling MFA or Multi-Factor Authentication. Do this.
        <ul>
          <li>It is a little bit of a pain but it gets you another measure of security for your cloud account</li>
          <li>Your MFA device is probably a smart phone. Here are the links for procedures to…
            <ul>
              <li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html">Activate</a></li>
              <li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_disable.html">De-activate</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Start and Stop an EC2 instance: Know what it costs, what EBS is, and log in to it before you Stop it.</li>
  <li>Study up on cloud tech, enough to understand cost, security and capacity; and then make a plan.</li>
</ul>

<h2 id="cost-tracking-via-tags">Cost tracking via tags</h2>

<p>On AWS you can allocate assets such as S3 storage buckets and EC2 compute instances. These in turn cost money
(either actual money or credits if you have them available) and you probably care about how much. To this end
you can tag each asset. A tag is a key-value pair that you can establish through the AWS console; for example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Name: kilroy
Project: genomics101
</code></pre>
</div>

<p>After a month you can determine how much your resources for project <em>genomics101</em> are costing you.
Use the AWS Cost Explorer. Remember that resources may be distributed across regions; so be sure to
scan all regions or use the regional value ‘global’.</p>

<p>DLT daughter accounts support only a certain set of key values, listed below. In addition to the
typical ones there are 10 ‘CA’ keys that can mean anything you like. The point is that the Cost Explorer
will allow you to sort using these keys for your tags if necessary.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Application
CA001
CA002
CA003
CA004
CA005
CA006
CA007
CA008
CA009
CA010
Company
Contract
CostCode
CreationDate
Creator
Department
DeptCode
Environment
Grant
Location
Name
Order
Organization
OU
Owner
Payer
Product
Project
ProjectName
ProjectNumber
ProjectType
ResponsibleParty
Role
Service
Status
Use
</code></pre>
</div>

<p>The HPC Club account uses the Project key in billing tags. Each student researcher will have
an assigned project string, the lead researcher’s NetID.</p>

<h1 id="iam">IAM</h1>

<p>Let’s get working definitions:</p>

<ul>
  <li>Key pair: A certificate used to access some resource like an EC2 instance</li>
  <li>Credential: Generically an access mechanism: User name + password; or access keys</li>
  <li>User: A person who is affiliated with the account; has some form of access
    <ul>
      <li>i.e. is a person with an associated access key: Public and Private text strings; in one file, kept in a secure location</li>
      <li>This is <strong>distinct</strong> from the key pair (official term) associated with an EC2 instance used for logging in to that instance!!!</li>
    </ul>
  </li>
  <li>Group: A collection of Users
    <ul>
      <li>Can have a permission attached that applies to all IAM Users in that group</li>
    </ul>
  </li>
  <li>Role: Similar to a User but without visible Credentials
    <ul>
      <li>A Role exists as an abstract Thing – with a unique name – where it is actually <em>defined</em> by the policies attached to it</li>
      <li>Roles are nice because they have temporary Credentials that are automatically generated and invisible to our view of what is happening</li>
      <li>You <em>assume</em> a role
        <ul>
          <li>An EC can assume a role on launch: For example <strong>Can Write To S3</strong></li>
          <li>Federated identities: Once you authenticate you assume a role based on some pre-existing rule / logic</li>
          <li>Other AWS services can assume roles</li>
          <li>IAM Users can assume roles</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Policy: Is a set of conditions that is <em>attached</em> to an IAM Role or to an IAM User or an IAM Group
    <ul>
      <li>Thought of as a set of permissions, or “the way that you assign permissions”</li>
      <li>Policies are evaluated at the time of a request submitted to AWS; see below</li>
    </ul>
  </li>
  <li>Policy Evaluation
    <ul>
      <li>By default: Everything starts with a <strong>DENY</strong></li>
      <li>Upon request: All policies are evaluated at once; there is no order of evaluation
        <ul>
          <li>If there is an explicit DENY it wins, even over an explicit ALLOW</li>
          <li>If DENY is not present: Look for ALLOW: If found: Ok. Else: See default, above.</li>
          <li>One more detail: There is also ALLOW a NOT which is not as strong as DENY: It can be overridden by another ALLOW.</li>
        </ul>
      </li>
      <li>Debugging concept: If you have explicitly set ALLOW for something that still does not happen
        <ul>
          <li>There must be an explicit DENY somewhere else that you have not noticed</li>
        </ul>
      </li>
      <li>Basic elements of policies:
        <ul>
          <li>There is always an <strong>Action</strong>: What the API commands are.
            <ul>
              <li>‘*’ is wildcard do anything.</li>
              <li>‘S3:*’ is like the S3 API call, again with wildcard: Can do any action on S3</li>
            </ul>
          </li>
          <li>There is always a Resource: In a sense the <strong>Action</strong>’s Direct Object: What the action is applied to</li>
          <li>There is always an Effect: Logical ALLOW or DENY; logical condition as noted above</li>
          <li>More: There is a great deal more to Policies and Policy Evaluation…
            <ul>
              <li>For example conditional stuff like CIDR blocks allowed to connect to a VPC</li>
              <li>To pursue in depth: Don’t use cloudmaven; go direct to the AWS resource content</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h1 id="iam-access-example-spot-market">IAM Access Example: Spot market</h1>

<p>When the Power User policy (an AWS-managed policy) is assigned to an IAM User they still do not have the ability to 
do IAM tasks such as passing a role to an instance. So Bill (an IAM User) has Power User access; which in turn has 
an explicit ALLOW of NOT IAM. This means IAM tasks are not available to Bill; but Bill wishes to use the Spot market
which in turn requires an EC2 instance to receive an appopriate Spot Fleet role. What to do? First let us anticipate 
that this problem will recur; therefore let’s solve the problem with a Group. Second since the Power Access policy
does not include an DENY it can be overridden. Therefore:</p>

<ul>
  <li>Create Group SpotFleetAccess</li>
  <li>Include Bill in this Group</li>
  <li>Create a new Policy (see below) that has the desired ALLOW actions
    <ul>
      <li>Lines that provide IAM Role assignment</li>
      <li>Lines that allow S3 access</li>
    </ul>
  </li>
  <li>Assign this Policy to the same Group</li>
</ul>

<p>Whereupon Bill now logs in and can spin up EC2 instances that access S3; and these instances receive a role that
allows them to come from the Spot market pool.</p>

<p><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-fleet-requests.html">This link gives the necessary Spot Fleet policy</a>.
Here is an example of the text; note the explicit ALLOW of PassRole, ListRoles, ListInstanceProfiles. This is required to work
with Spot Fleet.  Note: We recommend getting the actual text for this policy from the above link.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"ec2:*"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="s2">"iam:PassRole"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"iam:ListRoles"</span><span class="p">,</span><span class="w">
              </span><span class="s2">"iam:ListInstanceProfiles"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nt">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_AWS.html" class="btn btn-default navbar-btn cursorNorm" role="button">AWS</a>
        
        
        
        <a href="tag_cloud_basics.html" class="btn btn-default navbar-btn cursorNorm" role="button">cloud_basics</a>
        
        
        
        <a href="tag_console.html" class="btn btn-default navbar-btn cursorNorm" role="button">console</a>
        
        
        
        <a href="tag_api.html" class="btn btn-default navbar-btn cursorNorm" role="button">api</a>
        
        
        
        <a href="tag_account_management.html" class="btn btn-default navbar-btn cursorNorm" role="button">account_management</a>
        
        
        
    </div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
<p>Support for this program is provided in part by the NSF Campus Cyberinfrastructure (CC*IIE) program, grant award number ACI-1440281.</p>
<br>
               &copy;2017 cloudmaven. All rights reserved. <br />
<span>Page last updated:</span> January 26, 2017<br/> Site last generated: Sep 9, 2017 <br />
<p><img src="images/cloudmaven_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
